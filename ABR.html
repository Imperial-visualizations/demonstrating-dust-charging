<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ABR - Charging Models - Imperial Visualisations</title>
    <link rel="icon" href="https://www.imperial.ac.uk/T4Assets/favicon-196x196.png" type="image/x-icon">
        <link rel="stylesheet" href="https://rawgit.com/Imperial-visualizations/Physics-Visualizations/master/css/skeleton.css">
   <link rel="stylesheet" href="https://rawgit.com/Imperial-visualizations/Physics-Visualizations/master/css/style.css">

   <script src="scripts/plotly-1.47.4.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="scripts/numeric/src/numeric.js"></script>
    <script src="https://unpkg.com/mathjs@6.0.2/dist/math.min.js"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          extensions: ["tex2jax.js"],
          jax: ["input/TeX", "output/HTML-CSS"],
          tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true
          },
          "HTML-CSS": { fonts: ["TeX"] }
        });
      </script>
    <script type="text/javascript" src="scripts/MathJax-master/MathJax.js"></script>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">

</head>

<body>
<div class="container">
    <div class = "row">
            <div class = "twelve columns">
                <p style="font-style: bold; font-size:large">
                    <h3>DRAFT/COPIED - Radial motion theory - ABR</h3>
                    <h5>Establishing an ODE</h5>
                    ABR assumes that ions and electrons are collisionless and initially stationary far from 
                    the dust grain. Thus any gain in the electron or ion is due to electrostatic potential $V(r)$, with 
                    the ions and electrons moving radially with respect to the dust grain, 
                    $$\frac{1}{2}m_iu^2_i = -eV(r)$$
                    where $u_i$ is the inward ion velocity and V(r) tends to zero a infinity. Via Poisson's equation we relate the potential with the electron 
                    and ion densities, $n_e$ and $n_i$ respectively.
                    $$\nabla^2V(r) = \frac{e(n_i - n_e)}{\epsilon_0}$$
                    In the steady state for the dust grain the electron and current will be equal $I_e = I_i$. The ion 
                    current, at a distance $r$, may be expressed as 
                    $$I_i = 4\pi r^2 n_i(r)eu_i(r)$$
                    $$n_i(r) = \frac{I_i}{4 \pi r^2 e u_i(r)}$$
                    Assuming that the electron density follow a Boltzmann distribution, it may be expressed as 
                    $$n_e(r) = n_0exp[\frac{eV(r)}{kT_e}]$$
                    where $T_e$ is the electron temperature and $n_0$ is the plasma density within which the dust grain is situated.
                    Therefore the electron current is given by 
                    $$I_e = -4\pi R^2en_0\sqrt{\frac{kT_e}{2\pi m_e}}exp(\frac{eV_p}{kT_e})$$ CHECK THIS!!!!. To facilitate numerical
                    integration later on we define normalised units as follows
                    $$\phi = \frac{-eV}{kT_e}\text{,}\quad\rho = \frac{r}{\lambda_D}\text{,}\quad P = \frac{R}{\lambda_D},\quad N_i = \frac{n_i}{n_0},\quad N_e = \frac{n_e}{n_0}$$
                    $$J = \frac{I_i}{4\pi \lambda^2_D n_0e\sqrt{\frac{2kT_e}{m_i}}}$$
                    where $\lambda_D$ is the electron Debye length, given by
                    $$\lambda_D = \sqrt{\frac{\epsilon_0 k_B T_e}{n_0 e^2}}$$. 
                    The radial component of Laplace operator, $\nabla^2$, in spherical coordinates is given by 
                    $$ \frac{1}{r^2}\frac{\partial}{\partial r}(r^2\frac{\partial}{\partial r})$$
                    We now substitute these normalised variables into our Poisson equation using the spherical coordinate representation
                    $$\frac{1}{\rho^2}\frac{d}{d\rho}(\rho^2\frac{d\phi}{d\rho}) = N_i - N_e$$
                    Re-arranging $N_{i,e}$ in terms of normalized variables, $N_i = J \phi^{\frac{-1}{2}}/\rho^2$ and $N_e = exp(-\phi)$.
                    <br>
                    <br>
                    <br>
                    <h5>Boundary Conditions</h5>
                    In order to integrate our normalised Poisson equation numerically we require three boundary conditions to calculate $\phi$
                    for any $\rho$. We begin by assuming that at some distance $\phi_b$ from the dust grain the plasma conditions are such that 
                    quasi-neutrality may be assumed. This means that at $\phi_b$, the variables $N_i$,$N_e$ are much larger than the left hand side of the 
                    Poisson equation hence, setting this side to zero, we re-arrange for $\rho$,
                    $$\rho \approx \frac{J^{\frac{1}{2}}exp(\frac{\phi}{2})}{\phi^{\frac{1}{4}}}$$
                    this is known as the "plasma solution". In order to produce our secondary boundary condition we take the 
                    derivative of the plasma solution with respect to $\rho$ and evaluate at $\rho_b$
                    $$[\frac{d\phi}{d\rho}]_{\rho_b} = \frac{2\rho_b \phi^{\frac{3}{2}}_{b} exp(-\phi_b)}{J(\phi_b - \frac{1}{2})}$$
                    where $\phi_b$ is the potential evaluated at $\rho_b$. Finally we require a relation between $J$ and $\phi_b$, this is produce via
                    taking the derivative of the plasma solution in order to find an expression for
                    $$\frac{d}{d\rho}(\rho^2\frac{d\phi}{d\rho})$$
                    given our assumptions for the plasma condition at $\rho_b$ the above expression will only be valid if it is small relative
                    to $J\phi^{\frac{-1}{2}}$ the expression for $N_i \rho^2$. This produces a "plasma condition" given by 
                    $$\frac{4\phi(2\phi - 3)(2\phi + 1)}{(2\phi - 1)^3} \ll \frac{J}{\phi^{\frac{1}{2}}}$$
                    thereby producing our third boundary condition of 
                    $$\frac{J}{\gamma} = \frac{4\phi^{\frac{3}{2}}(2\phi - 3)(2\phi + 1)}{(2\phi - 1)^3}$$
                    where $\gamma$ is an arbitrary value much larger than unity. By selecting a value for $J$ and $\gamma$ one can find a
                    a value for $\phi_b$, which may then be used to calculate $\rho_b$ and $[\frac{d\phi}{d\rho}]_{\rho_b}$. Once these are calculated, 
                    a numerical integrator may be used to solve this initial value problem for $\phi$.
                    </p>
            </div>
    </div>
    <div class = "row">
        <div class="six columns">
            <div id="graph_phi" ></div>
        </div>
        <div class="six columns">
            <div id="graph_J" ></div>
        </div>
    </div>
<br>
    <div class = "row">
        <div class = "five columns">
            <div id="gamma-slider">
                    <label for="Gamma" class="sliderTitle">Gamma: 10^<span id="gamma-display"></span>
                    </label>
                    <span class="sliderMin">0</span>
                    <input type="range" id="gamma" name="gamma" min="0" max="4" value="3">
                    <span class="sliderMax">4</span>
            </div>
        </div>
    </div>
<br/>
    <div class = "row">
        <input type="button" id="FloatButton" value="Produce Graph">
        <div class="twelve columns">
            <div id="graph_floating" ></div>
        </div>
    </div>
</div>
<script src="scripts/ABR.js"></script>
</body>
</html>